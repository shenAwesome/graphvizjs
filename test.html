<html>

<head>
    <script src='./dist/graphviz.js'></script>
    <style>
        svg {
            border: 1px solid gray;
        }
    </style>
</head>

<body style="margin:10px">
    <div style="width:calc(100vw - 20px);height:calc(100vh - 20px);display:flex;">
        <div style="flex-grow: 1;">
            <textarea id="dot"
                style="width:100%;height:100%;background-color: rgba(0,0,0,.1);padding:.5em;outline:none;"></textarea>
        </div>
        <div style="overflow: auto; flex-grow: 1;">
            <div id="chart" style="margin-left:1em;"></div>
            <div id="error" style="color:red;"></div>
            <br>
            <a href="https://renenyffenegger.ch/notes/tools/Graphviz/examples/index" target="_blank"
                style="margin:1em;">Sample</a>
        </div>
    </div>

    <script>

        window.addEventListener('load', async () => {
            const dotInput = document.querySelector('#dot')
            const chart = document.querySelector('#chart')
            const error = document.querySelector('#error')
            const viz = await graphviz.initViz()

            function render() {
                chart.innerHTML = ''
                error.innerHTML = ''
                try {
                    chart.innerHTML = viz.layout(dotInput.value)
                } catch (e) {
                    error.innerHTML = e
                }
            }
            dotInput.addEventListener('input', render)
            dotInput.innerHTML = `digraph D {  A -> {B, C, D} -> {F} }`
            render()
        })

    </script>
</body>

</html>